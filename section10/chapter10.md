## 第10章：循环

循环让相同的代码多次重复变得很容易。

相比函数，他们的好处略有不同：函数允许你重用代码，循环允许你重复代码。

在介绍list的一章里，我们已经用到for循环了。这章我们将更深入的介绍for循环，同时也会介绍另一种新类型的循环。

迭代是另一种常见的循环。

#### 10.1 Minecraft练习

##### 10.1.1 点石成金

-----------------------------------

**知识与技巧**

本练习中，我们将练习的知识和技巧:

* while  循环
* 嵌套if语句

-----------------------------------

迈达斯（Midas）是一位传奇国王。他摸过的任何东西都会变成金子。你将写一段代码，把玩家下面的任何块都变成金子。好吧，不是所有的块都变成金子，我们还得让空气块和水保持不变。黄金块的值是41。

**指令**

用注释做指引，完成下面的代码：

	1. # 连接 Minecraft
	2. while True:
	3.     # 得到玩家的坐标
	4.     # 如果玩家下面的块不是水或空气
	5.         # 把块变成黄金

##### 10.1.2 树战斗机（Tree Fighter）

-----------------------------------

**知识与技巧**

本练习中，我们将练习的知识和技巧:

* while  循环
* for  循环
* 变量
* 求和

-----------------------------------
玩家通过点击鼠标右键，可以让他手中剑击打块。使用pollBlockHits函数，可以获得玩家击中块的列表。通过这个函数和for循环，我们可以对玩家击中的每一块执行代码。

因为当for循环遍历完所有数据项后就会停止，所以我们需要再加一个while循环，来保证for循环每秒钟都能执行多次。基本代码是这个样子的：

	1. import mcpi.minecraft as minecraft
	2. import time
	3. mc = minecraft.Minecraft.create()
	4.
	5. while True:
	6.     hits = mc.events.pollBlockHits()
	7.     for hit in hits:
	8.         print str(hit.pos.x) + ”, ” +  str(hit.pos.y) + ”, ” + str(hit.pos.z)
	9.     time.sleep(0.1)

这段代码将打印所有被击中块的坐标。代码中加入Sleep函数，是为了不让循环执行的太快，以免拖慢了整个游戏运行。

**指令**

你的任务是写一个小游戏，让玩家必须点击右键，用他们的剑击打20课树木。

修改上面的代码，完成下面的任务：

玩家点击右键，击打20课树木后，while循环停止
每次点击后，把击打树木的数量，发送到聊天窗口
20次击打完成后，发送“祝贺消息”到聊天窗口，然后停止程序
修改它，即便把Minecraft设置成“不可变更”的，玩家也可以删除块。【怪异，怎么实现？】

**扩展练习**

打你击打块的时候，随机改变块的类型
目前，玩家可以通过打次击打同一木块来欺骗程序。保存被击打的块的记录，避免玩家多次击打同一块。

##### 10.1.3 聊天和循环

-----------------------------------

**知识与技巧**

本练习中，我们将练习的知识和技巧:

* while  循环
* break终端语句
* 条件
* 输入输出

-----------------------------------

本书的前几章我们介绍了字符串，输入输出，你也完成了一个任务：写一段程序，发送到聊天窗口。这段程序虽然能用，但是特别麻烦，发送一条消息，就得运行一次程序。

在这个练习里，我们会改进这个聊天程序，利用while循环，让它启动一次就可以发送多条消息。

**指令**

编写一段程序，满足下列需求：

* 在程序开始后，询问用户名
* 用户可以从控制台输入消息
* 把用户输入的消息，发送到Minecraft聊天窗口
* 所有消息里都包括用户名
* 程序重复请求发送的消息
* 当有用户加入或离开聊天时，发送通知到聊天窗口
* 输入“/exit”时，用户推出聊天

在练习目标（知识与技巧）里，可以找到你需要用到的Python 概念。

##### 10.1.4 金字塔

-----------------------------------

**知识与技巧**

本练习中，我们将练习的知识和技巧:

* 嵌套for循环

-----------------------------------

循环在创建结构和建筑的时候也非常有用。通过你的代码，你可以修建真正复杂的事情。例如，用下面的代码修建一个三角形：

	1 import mcpi.minecraft as minecraft
	2 mc = minecraft.Minecraft.create()
	3
	4 pos = mc.player.getTilePos()
	5 x = pos.x + 2
	6 y = pos.y
	7 z = pos.z
	8
	9 base = 9
	10 height = 0
	11 sandstone = 24
	12
	13 while base - (2 * height) > 0:
	14     for block in range(base - (2 * height)):
	15         mc.setBlock(x + block + height, y +  height, z, sandstone)
	16     height += 1
	
**指令**	
	
修改上面三角形的代码，在Minecraft世界里建造一个金字塔。

**扩展练习**

* 每五块就挖空，包括地板

##### 10.1.5 热与冷

-----------------------------------

**知识与技巧**

本练习中，我们将练习的知识和技巧:

* while循环
* 条件
* if语句
* elif语句
* else语句

-----------------------------------

热与冷是我们小时候玩过的游戏。这个游戏的内容是你的朋友把什么东西藏起来，你必须找到。你的朋友给你物品离你多远的提示。你接近是热，远离是冷。着火意味着东西就在你旁边。冻结意味着东西已经走远了。

**指令**

利用你Python和Minecraft API的知识，编写程序，在Minecraft里创造一个热与冷的游戏。玩家的目标是找到并粉碎，随机出现在游戏世界里的钻石块。

当玩家找到并粉碎钻石块后，你的程序就得结束了。利用相关函数计算玩家和钻石块的距离。

你写到代码先要随机放置钻石块，注意，别放到地下了。

	1. import mcpi.minecraft as minecraft
	2. import math
	3. import time
	4. import random
	5. mc = minecraft.Minecraft.create()
	6.
	7. tileX = random.randint(-127, 127)
	8. tileZ = random.randint(-127, 127)
	9. tileY = mc.getHeight(tileX, tileZ)
	10.
	11. diamond = 57
	12. block = diamond
	13. mc.setBlock(tileX, tileY, tileZ, diamond)
	14. mc.postToChat(”Block set”)

**扩展练习**

* 用热和冷的玩法，跨地图隐藏炸药块，给玩家5分钟到找到并解除它们。

##### 10.1.6 改编练习

前几章课里的练习程序都有个问题，每次你想让它做什么的时候，都得重新运行程序。这些程序都可以从无限循环中受益。下面是可以加入循环的程序列表：
* 设置玩家下的块
* 聊天
* 游泳
* 给我一课树苗
* 洗澡
* 秘密通道
* 引爆TNT
* 自旋的指示牌
* 团队相机